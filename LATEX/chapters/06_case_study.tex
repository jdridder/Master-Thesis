\chapter{Case Study}

The goal of this work is to derive a physics-consistent surrogate modelling technique to be applied within a robust MPC algorithm.
Physics consistency, prediction accuracy and uncertainty quantification will be assessed using a case study of a catalytic \emph{packed-bed tubular reactor}.
This reactor type is common in the chemical industry in many processes such as ethylene oxidation, carbon dioxide methanization or steam reforming.
Especcially with regard to \emph{load flexible} processes using renewable energy sources, dynamic control such as MPC can enable optimal operation \cite{fischer2021}. For example, the energy supply can be closely tied to weather conditions or the feed composition may fluctuate due to
biological resources.
\newline
\newline
For exothermal reactions, \emph{transient behavior} is a mayor safety concern of packed-bed tubular reactors \cite{guttel2021}.
In a dynamic operating environment, the thermal inertia of the catalytic packed bed can abruptly heat up unreacted feed mixture.
This can cause a self-accelerating temperature runaway leading to thermal damage or even explosion.
Furthermore, high temperatures can cause several catalyst deactivation effects such as sintering. Therefore, the temperature
is considered a safety-crucial state that needs to obey to a maximum constraint in the sense of $F_i \leq 0$ in the original optimization (def.~\ref{theroy:def: bi-level program}) for all possible disturbances $\vw$.
The maximum of $F_i$ should be approximated by $\tilde{\varphi}_i(\vu)$. This will be achieved by training a NARX model that predicts
a tuned upper and lower bound for $\tilde{\varphi}_i(\vu)$ independent from the uncertainty $\vw$ using quantile regression.
Apart from safety, the maximization of the selectivity towards the value product is a reasonable control objective, as the selectivity
is most correlated to process profitability in many cases. To achieve a reasonable turnover from educts to products, a minimum 
conversion is set to be required via a constraint. In total, following general optimization structure is proposed.
\begin{equation}
    \label{case:eq: general optimization}
    \begin{gathered}
        \max \; S \\
        \begin{aligned}
            \text{s.t.} \quad T &\leq T_\text{max} \\
            X &\geq X_\text{min}
        \end{aligned}
    \end{gathered}
\end{equation}

\section{Reaction Kinetics}
To focus on the surrogate modelling methology, the example system is kept rather simplistic. 
The \emph{ethylene oxidation} process consists of only two parallel reactions. Parametric data
is readily available due to extensive literature about this reaction system. Further, the reaction and 
reactor configuration is taken from an optimal reactor design study by Pietschak et al. \cite{pietschak2018} and
adjusted for the needs at hand. Thus, some proposed operating conditions may be unrealistic due to safety concerns
or over-simplifications.
\newline
\newline
Ethene is partially oxidized to ethylene oxide, while the total oxidation (combustion) of ethene takes place
as a parallel reaction to carbon dioxide and water (eq.~\ref{case:eq: reaction equation}). According to the kinetics of Al-Saleh et al. \cite{alsaleh1988},
the consecutive reaction from ethylene oxide to water and carbon dioxide can be neglected.
\begin{equation}
    \label{case:eq: reaction equation}
    \begin{gathered}
        \mathrm{C_2H_4} + \frac{1}{2} \; \mathrm{O_2} \rightarrow \mathrm{C_2H_4O} \\
        \mathrm{C_2H_4} + 3 \; \mathrm{O_2} \rightarrow 2 \; \mathrm{CO_2} + 2 \; \mathrm{H_2O} \\
        \mathrm{C_2H_4O} + \frac{5}{2} \mathrm{O_2} \rightarrow 2 \mathrm{CO_2} + 2 \; \mathrm{H_2O}
    \end{gathered}
\end{equation}
The reaction rates can be described using following rate expression (eq.~\ref{case:eq: reaction rate}).
\begin{equation}
    \label{case:eq: reaction rate}
    r_j = \frac{k_j p_\text{E}^{n_j^{(\text{E})}} p_\text{O2}^{n_j^{(\text{O2})}}}{1 + K_j p_\text{CO2}}
\end{equation}
Here, $r_j$ denotes the reaction rate of reaction $j$, $k_j$ the collision factor, $p_\alpha$ the partial pressures of
component $\alpha$ and $K_j$ the adsorption coefficient for carbon dioxide. 
The reaction orders w.r.t ethene and oxygen are expressed by $n_j^{(\text{E})}$ and $n_j^{(\text{O2})}$ respectively.
The collision factor and the adsorption
coefficient follow simple Arrhenius correlations (eq.~\ref{case:eq: collision factor},~\ref{case:eq: adsorption coefficient}).

\begin{equation}
    \label{case:eq: collision factor}
    k_j = k_{0, j} \exp \bigg ( \frac{-E_{\text{A},j}}{\mathrm{R} T} \bigg)
\end{equation}
\begin{equation}
    \label{case:eq: adsorption coefficient}
    K_j = K_{0, j} \exp \bigg ( \frac{T_{\text{ads},j}}{T} \bigg)
\end{equation}
These introduce a strong non-linearity in the temperature $T$ and the kinetic parameters. The upright letter $\mathrm{R}$ represents the 
universal gas constant, $E_\text{A}$ the activation energy, $k_{0, j}$ and $K_{0, j}$ the respective pre-exponential factors
and $T_{\text{ads},j}$ the adsorption temperature. To simulate these kinetics, the partial pressures
of the rate determining species ethene, oxygen and carbon dioxide must be known.
The kinetic parameters are listed below (tab.~\ref{case:tab: true kinetic parameters}) and will further underly probabilistic uncertainty. 

\section{Packed-bed Tubular Reactor Model}
The reactor as a packed-bed tubular reactor (TR) is assumed to be already existend with a fixed design to clearly separate the model derivation
from an optimal design task (fig.~\ref{case:fig: complete reactor}). To ensure thermal stability, the additional enthalpy balance is mandatory. 

\begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{Figures/Reaction-Modelling/reactor-complete.pdf}
    \caption[Catalytic packed-bed flow reactor]
    {The packed-bed reactor is assumed to exhibit plug flow behavior (green). Catalyst and gaseous phase are lumped into
    one pseudo-homogenious reaction phase. The inlet conditions remain constant for the temperature $T$ and the 
    molar fractions of each component $x_{(\cdot)}$, while the inlet flow speed $u$ can fluctuate due to flexible feed availability.
    Four cooling sections (blue) are integrated.}
    \label{case:fig: complete reactor}
\end{figure}


\subsection{PDE System Derivation}

The technical reactor itself is equipped with four wall cooling sections ($T_{\text{w,1}}$ to $T_{\text{w,4}}$) to manipulate the temperature profile (blue).
The input flow velocity $u$ can fluctuate due to flexible feed availability such as in carbon dioxide methanization,
where the throughput heavily relies on the hydrogen supply \cite{fischer2021}. Because isobaric conditions and a non-compressible phase are assumed,
the simulated states narrow down to the molar fractions of the rate-determining species $x_\alpha$ and the temperature $T$.
These are considered to be constant at the inlet, which is important for the later application of 
linear equality constraints in a NN. 
Using the component balace in local form (eq.~\ref{case:eq: component balance in local form}), a PDE can be derived that
describes the dynamic concentration gradients of the components $\alpha$.
Furthermore, the enthalpy balance shall be covered to calculate the temperature field regarding the exothermic
reactions.

\begin{equation}
    \label{case:eq: component balance in local form}
    \frac{\partial \rho_\alpha}{\partial t} = - \frac{\partial}{\partial z_k} (\rho_\alpha u_k + j_{\alpha, k}) + \sigma_\alpha
\end{equation}
The general component density $\rho_\alpha$ is expressed in mol/m$^3$, while $\partial z_k$ indicates
the spatial derivative in direction $k$. $u_k$ and $j_{\alpha, k}$ denote the convective velocity and the 
diffusive mass transport in direction $k$. The source or sink term $\sigma_\alpha$ allows to consider chemical reations.
Ideal gas behavior is considered (eq.~\ref{case:eq: ideal gas law}).
\begin{equation}
    \label{case:eq: ideal gas law}
    p_\alpha = \rho_\alpha \mathrm{R} T
\end{equation}
Moreover, \emph{plug flow} and constant pressure are assumed. 
Under the consideration of a 1D-pseudo-homogenious model with gradients only in axial direction and no
diffusive mass transfer, this equation reduces to an ideal \emph{plug flow tubular reactor} (PFTR) (eq.~\ref{case:eq: dimensionless component PDE}).
A detailed derivation of the model equations can be found in the appendix (XX). 
\begin{equation}
    \label{case:eq: dimensionless component PDE}
    \begin{gathered}
        \frac{\partial \chi_\alpha}{\partial t} = - u \frac{\partial \chi_\alpha}{\partial z}
        + (1 - \epsilon) \frac{\mathrm{R} T_*}{p x_*} \sum_j \nu_{\alpha,j} r_j(\chi_\alpha, T') \\
        \text{with} \quad \chi_\alpha = \frac{x_\alpha'}{T'} \quad 
        x_\alpha' = \frac{x_\alpha}{x_*} \quad
        T' = \frac{T}{T_*}
    \end{gathered}
\end{equation}
To improve numerical stability, the mole fractions $x_\alpha$ and the temperature occur in a dimensionless
form indicated by a prime (') symbol. This is done by diving by a reference value, denoted with a star (*) (eq.~\ref{case:eq: dimensionless component PDE}).
It not only improves numerical simulation stability. For the later training of surrogate models, it also eliminates the need for
an \emph{output scaler} which simplifies implementation and training. These reference values are defined as follows (eq.~\ref{case:eq: reference values for scaling}).
\begin{equation}
    \label{case:eq: reference values for scaling}
    x_* = x_\text{E,in} \quad T_* = T_\text{in}
\end{equation}
Due to the ideal gas behavior (eq.~\ref{case:eq: ideal gas law}), the molar density $\rho_\alpha$ varies not only
with the molar fraction but also with the temperature. Therefore, an artificial state $\chi_\alpha$ is introduced
to enable an easy and explicit formulation of the PDE via substitution (eq.~\ref{case:eq: dimensionless component PDE}).
\newline
\newline
The general enthalpy balance in local form (eq.~\ref{case:eq: enthalpy balance local form}) can be significantly reduced under isobaric conditions with neither volume forces,
nor friction, nor dispersive, nor conductive enthalpy transfer.
\begin{equation}
    \label{case:eq: enthalpy balance local form}
    \frac{\partial (\rho h)}{\partial t} - \frac{\partial p }{\partial t} = 
    -\frac{\partial}{\partial z_k} \bigg (\rho h u_k + q_k' \bigg) + 
    u_k \frac{\partial p}{\partial z_k} + \sum_i j_{k,i} f_{k,i} -
    \Pi_{j,k} \frac{\partial u_j}{\partial z_k} + \sigma_h
\end{equation}

The final PDE to describe the temperature field in the reactor is yielded (eq.~\ref{case:eq: dimensionless temperature PDE}).
\begin{equation}
    \label{case:eq: dimensionless temperature PDE}
    \frac{\partial T'}{\partial t} = -u \frac{\partial T'}{\partial z} +
    \frac{1}{\rho c_\text{p}} \bigg ( \frac{1-\epsilon}{T_*} \sum_j (-\Delta h_{\text{R},j}) r_j
    + \frac{4}{d_\text{t}}  \alpha \big (\frac{T_\text{w}}{T_*} - T' \big) \bigg)
\end{equation}
Important parameters are the bed void fraction $\epsilon$, the tube diameter $d_\text{t}$, the enthalpy of reaction
$\Delta h_{\text{R}, j}$, the total density $\rho$ and the total heat capacity $c_\text{p}$. The wall heat transfer
is assumed to only be governed by the fluid-wall heat transfer coefficient $\alpha$, which is a function
of the fluid velocity and the radial heat conductivity of the catalytic bed (eq.~\ref{case:eq: heat transfer coefficient}).
In fact, this parameter abbreviated
with $\lambda_\text{bed}$ is crucial for the temperature behavior of the TR. Underlying dependecies like
Reynolds and Prandl expressions are part of the appendix to keep the derivation tidy.
\begin{equation}
    \label{case:eq: heat transfer coefficient}
    \alpha = f(\mathrm{Re}, \mathrm{Pr}, \lambda_\text{bed})
\end{equation}

\subsection{Discretization}

The system of non-linear PDEs is discretized in $z$-direction via \emph{backward finite differences}.
\begin{definition} Discretized system of PDEs using backward finite differences to yield an ODE system
    \label{case:def: discretized system of PDEs}
    \[
    \begin{aligned}
        \frac{d \chi_{\alpha,i}}{d t} &= - u \frac{\chi_{\alpha,i} - \chi_{\alpha,i-1}}{\Delta z}
        + (1 - \epsilon) \frac{\mathrm{R} T_*}{p x_*} \sum_j \nu_{\alpha,j} r_j(\chi_{\alpha,i}, T'_i) \\
        \frac{d T'_i}{dt} &= -u \frac{T'_{i} - T'_{i-1}}{\Delta z} +
        \frac{1}{\rho c_\text{p}} \bigg ( \frac{1-\epsilon}{T_*} \sum_j (-\Delta h_{\text{R},j}) r_j(\chi_{\alpha,i}, T'_i)
        + \frac{4}{d_\text{t}}  \alpha \big (\frac{T_{\text{w},i}}{T_*} - T'_i \big) \bigg)
    \end{aligned}
    \]
\end{definition}

The nodes of the discretization are choosen to be equidistant. For a reactor length of $L=10 \; \mathrm{m}$, $128$
points are used. This results in a length of $\Delta z = 0.0781 \; \mathrm{m}$ for each element.
As the finite difference method exhibits a significant truncation error of $\mathcal{O}(\Delta z)$, more accurate discretization
methods such as finite volumes should be used for a real application.

\section{Parametric Uncertainty}

Because model parameters such as the activation energy or the pre-exponential collision factor are mostly fitted
by laboratory experiments that exhibit some kind of measurement uncertainty, the parameters themselves cannot be
exactly determined. They lie in a confidence intervall. Furthermore, fitting results with counteracting mechanisms
produce cross-correlations between parameters. For example, when a higher activation energy is determined, simutaneously
the according pre-exponential factor must be also higher to compensate for the reduced reaction speed. In this case study,
five first principle model parameters should be treated as uncertain. These are the radial bed heat conductivity $\lambda_\text{bed}$,
the activation energies $E_{\text{A},1}, E_{\text{A},2}$ and their respective pre-exponential collision factors $k_{0,1}, k_{0,2}$ for the main, and the side reaction.
The true values for all kinetic parameters are listed (tab.~\ref{case:tab: true kinetic parameters}).

\begin{table}
\caption[True kinetic parameters.]{True kinetic parameters for the ethene oxidation kinetics \cite{alsaleh1988}.}
\label{case:tab: true kinetic parameters}
\begin{center}
    \begin{tabular}{c c c}
        \toprule
        \multirow{2}{*}{\textbf{parameter}} & \multicolumn{2}{c}{\textbf{value}}\\ \cmidrule{2-3}
        & main reaction & side reaction \\
        \midrule
        $k_{0,j}$ & $6.275\times 10^6  \; \mathrm{mol \; kg_{cat}^{-1} \; Pa^{1.1} \; s^{-1}}$ & $1.206\times10^7 \; \mathrm{mol \; kg_{cat}^{-1} \; Pa \; s^{-1}}$ \\
        $E_{\text{A},j}$ & \SI{74900}{\joule \; \mole^{-1}}  & \SI{89900}{\joule \; \mole^{-1}} \\
        $K_{0,j}$ & \SI{1.985e2}{\pascal^{-1}}  & \SI{1.08e2}{\pascal^{-1}} \\
        $T_{\text{ads},j}$ & \SI{2400}{\kelvin}  & \SI{1530}{\kelvin} \\
        $\Delta h_{\text{R},j}$ & \SI{-1.07e5}{\joule \; \mole^{-1}}  & \SI{-1.323e6}{\joule \; \mole^{-1}} \\
        $n_j^{(\text{E})}$ & \num{0.6} & \num{0.5} \\
        $n_j^{(\text{O2})}$ & \num{0.5} & \num{0.5} \\
        \bottomrule
    \end{tabular} 
\end{center}
\end{table}

\subsection{Radial bed heat conductivity}
The radial bed heat conductivity is set to follow a normal distribution with a mean of $0.404~\;~\mathrm{W \; m^{-1} \; K^{-1}}$ calculated by a correlation by Zehner et al. \cite{zehner1970}
and a rather high standard deviation of $0.08~\;~\mathrm{W \; m^{-1} \; K^{-1}}$ (fig.~\ref{case:fig: lambda bed distribution}).
Its values range from $0.2$ to $0.6 ~\;~\mathrm{W \; m^{-1} \; K^{-1}}$.

\begin{definition} Normal distribition of the radial heat conductivity of the catalytic bed
    \label{case:def: heat conductivity distribution}
    \[
        \lambda_\text{bed} \sim \mathcal{N}(\mu_\lambda, \sigma_\lambda)
    \]
\end{definition}

\subsection{Activation Energies and Pre-exponential factors}
The activation energies and pre-exponential factors are assumed to arise from a multi-variate normal distribution, which
can be determined from a cross-correlated parameter fitting (def.~\ref{case:def: multi-variate distribution}).
\begin{definition} Multi-variate normal distribution of cross-correlated kinetic parameters
    \label{case:def: multi-variate distribution}
    \[
        \begin{pmatrix}
            \ln k_{0,1} \\ E_{\text{A}, 1} \\ \ln k_{0,2} \\ E_{\text{A}, 2} 
        \end{pmatrix} \sim \mathcal{N}(\bm{\mu}, \bm{\Sigma})
    \]
\end{definition}
The activation energy of the main reaction is plotted against its pre-exponential collision factor (fig.~\ref{case:fig: kinetic parameter distribution}).
While the true parameter combination is marked with a yellow point, the blue crosses indicate
the possible parameter combinations by sampling the multi-variate normal distribution (eq.~\ref{case:def: multi-variate distribution}).
The sampling is done $1000$ times. Activation enegies can range between \SI{65000}{} and \SI{85000}{\joule \; \mole^{-1}},
whereas the pre-exponential factor varies between \SI{1.5e6}{} and $3.0 \times 10^7 \; \mathrm{mol \; kg_{cat}^{-1} \; Pa^{1.1} \; s^{-1}}$.
To calculate the mean vector $\bm{\mu}$ and the covariance matrix $\bm{\Sigma}$, an actual parameter fitting with emulated
measurement noise has been executed using a \emph{berty} reactor model.
Mean and covariance can be consulted in the appendix (tab.~\ref{app:tab: mean and covariance}).

\begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{Figures/Reaction-Modelling/lambda_histogram.pdf}
    \caption[Parameter distribution for the radial heat conductivity.]
    {The radial heat conductivity of the packed bed follows a normal distribution with its mean 
    calculated by the correlation of Zehner et al. \cite{zehner1970} and a standard deviation of 
    $\sigma = 0.08 \; \mathrm{W m^{-1} K^{-1}}$, shown for $1000$ sampling points.}
    \label{case:fig: lambda bed distribution}
\end{figure}


\begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{Figures/Reaction-Modelling/kinetic_cross_correlation_k1_EA1.pdf}
    \caption[Parameter distribution for the activation energy and the collision factor.]
    {Due to the multi-variate normal distribution caused by an experimental parameter fitting and the non-linearity
    of the Arrhenius-Ansatz (eq.~\ref{case:eq: collision factor}), the activation energy and the pre-exponential
    factor show a non-linear uncertainty. The nominal value is marked in yellow.}
    \label{case:fig: kinetic parameter distribution}
\end{figure}

\section{Conservation of Atoms}

To formulate the conservation of atoms (th.~\ref{theory:th: conservation of atoms}) for the
ethene oxidation, the element-species-matrix $\bm{B}$ needs to be set up (def.~\ref{case:def: element-species-matrix}).
\begin{definition} Element-species-matrix for the ethene oxidation.
    \label{case:def: element-species-matrix}
    \[
    \bm{B} = \begin{pmatrix}
        4 & 0 & 4 & 2 & 0 \\
        2 & 0 & 2 & 0 & 1 \\
        0 & 2 & 1 & 1 & 2 \\
    \end{pmatrix}
    \]
\end{definition}
Here, the columns are ordered as follows: ethene, oxygen molecule, ethylene oxide, water and carbon dioxide.
The rows indicate elementary hydrogen, elementary carbon and elementary oxygen.
Under the assumptions taken earlier, mainly as ideal gas behavior and incompressibility, the change in molar amount
can be expressed in terms of the dimensionless state $\chi_i$ (eq.~\ref{case:ed: molar amount difference}).
\begin{equation}
    \label{case:ed: molar amount difference}
    \Delta n_i = ( \chi_{i,0} - \chi_{i} ) \frac{pV}{\mathrm{R}} \frac{x_*}{T_*}
\end{equation}
Thus, the original conservation law is yielded as follows.

\begin{corollary} Conservation of atoms with a dimensionless concentration measure.
    \label{case:cor: conservation of atoms}
    \[
        \bm{B} \bm{\Delta \chi} = \bm{0}
    \]
\end{corollary} 
Where, $\bm{\Delta \chi}$ marks the vector of the dimensionless changes for all components divided by the temperature.


\section{Measurement Positions}

For surrogate modelling, four measurement positions are introduced into the TR, where the temperature
and the dimensionless concentration measure $\chi_i$ should be measured and predicted (fig.~\ref{case:fig: measurement positions}).
The distribution is done equidistantly. Taking all system states into account, meaning the concentration
measure for all five components and the temperature, $6 \cdot 4 = 24$
measurements form. This denotes the output size of a surrogate model. Using the backward finite difference method with $128$ points,
the states at the positions $32, 64, 96$ and $128$ are considered as the measurements.
Regarding the contraint satisfaction of the temperature, it is suitable to use the maximum temperature in the reactor as
a measurement instead of discretizing spatially in a real-world scenario. The outlet states are of major interest in all cases.


\begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{Figures/Reaction-Modelling/reactor-measurements.pdf}
    \caption[Measurement positions in the tubular reactor.]
    {The four measurement positions $\vy_{(\cdot)}$ are located equidistant in axial direction.}
    \label{case:fig: measurement positions}
\end{figure}


\section{Experimental Setup}

The objective of this work is to derive, implement and analyze a physics consistent surrogate modelling strategy for
the ethene oxidation flow reactor under parametric uncertainty. During the whole procedure, the 
previously defined NARX framework is employed (def.~\ref{sur:def: general rhs for uncertainty quantification}).
It consists of a nominal prediction $\mathbb{E}$ and two quantile predictions $\hat{Q}_\tau$. 
All three predictors are separated in two parts.
The nominal prediction is inferred by a NARX model, that predicts the expected value of the critical state.

\begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{Figures/Procedure/narx_framework.pdf}
    \caption[NARX framework for uncertainty quantification.]
    {}
    \label{case:fig: narx framework}
\end{figure}




\subsection{Data Generation}

To train and test the NARX models, reactor measurement data is generated at mentioned positions. 
For this sake, the normal distributions for the radial heat conductivity and the kinetic parameters 
are sampled in Monte-Carlo (MC) fashion to yield a parameter vector $\vw$ in the uncertainty space.
For the inputs in the training data ($T_{\text{w,1}}$ to $T_{\text{w,4}}$), excited ramp signals are generated with an
uniform distribution. The distribution ranges from \SI{535}{\kelvin} to \SI{665}{\kelvin} for each input temperature.
Once a signal level is sampled, it is held for a random duration between $0.6$ and $1.8$ times of 
the system's time constant. The ramp duration is set to half of the system's time constant.
The same is done for the time-varying inlet flow speed with uniform boundaries of 
\SI{0.18}{\meter \; \second^{-1}} to \SI{0.42}{\meter \; \second^{-1}}.
Here, the hold duration is choosen to be longer with $1.75$ to $3.5$ times the system's time constant.
To capture dynamic and stationary behavior of the reactor model, hold durations below and above the 
biggest time constant are picked.
The heat transfer to the reactor wall is determined as the slowest time constant with
approximately \SI{20}{\second} (eq.~\ref{case:eq: time constant}).
\begin{equation}
    \label{case:eq: time constant}
    \tau = \frac{\rho c_\text{p} d_\text{t}}{4 \alpha} \approx \SI{20}{\second}
\end{equation}

\begin{figure}
    \centering
    \includegraphics[width=1\textwidth]{Figures/Reaction-Modelling/input_trajectories.pdf}
    \caption[Excited input trajectories for the four wall temperatures.]
    {For data generation, the wall temperatures are excited using uniform distribution for the level
    and the hold time. The latter is a multiplier of the system's biggest time constant. Excited input trajectories
    of the test data are shown for a simulation horizon of \SI{512}{\second}.}
    \label{case:fig: input trajectories}
\end{figure}
The excited input signals of the wall temperatures are shown (fig.~\ref{case:fig: input trajectories}) for
\SI{512}{\second} with a sampling frequency of \SI{1}{\second^{-1}}.

\subsection{Training}